介绍
段1：Deepfake技术的危害
段2：Deepfake的新技术，3个换脸
段3：先前的检测器Deepfake
段4：扩散模型生成检测方法
段5：我们提出的模型或检测方法

相关工作
段1：Deepfake 生成方法
段2：扩散模型
段3：重建误差

方法
段1：扩散模型
段2：Mask 条件的扩散模型
段3：DCT或DWT的扩散模型
段4：双流重建误差

实验：
扩散人脸数据集：ADM、LDM、SD ......
Deepfake 数据集：FF++,CDFv2，DFDC,DFDCP
扩散换脸数据：DiffSwap

消融：有Mask，无DCT
           有Mask，有DWT
	  有Mask，有DCT
	有DCT，无Mask
	有DWT，无Mask

热力图和显著图



---

基于掩码扩散重建和高频增强UNet的人脸伪造检测

# 一、摘要



# 二、介绍

**Deepfake技术的危害**  
深度伪造技术通过AI生成高度逼真的虚假内容，已对社会构成多维威胁。在政治领域，伪造政要的演讲视频可能操纵舆论、干扰选举；在司法层面，伪造的证据可能颠覆审判结果；对个人而言，"换脸"不雅视频导致敲诈勒索案件激增，受害者身心遭受重创。更值得警惕的是，该技术正被用于制造国家间的虚假外交声明，可能引发国际冲突。

**The Hazards of Deepfake Technology**  
Deepfake technology, capable of producing hyper-realistic synthetic media, poses multifaceted threats to society. Politically, fabricated speeches of leaders can manipulate public opinion and disrupt elections; judicially, AI-generated evidence may overturn legal verdicts. For individuals, "face-swapped" explicit videos have triggered a surge in sextortion cases, causing profound psychological trauma. Most alarmingly, the technology is being weaponized to fabricate cross-border diplomatic statements, potentially provoking international conflicts. 



**Deepfake技术**

人脸交换是计算机视觉领域中一个有趣但又具有挑战性的问题，其目的是将源图像的身份特征无缝地转移到不同的目标图像上，同时保留目标的姿势、表情和背景[1,2,4]。依赖gan进行人脸交换已经取得了显著的突破[4,17,21,33]，其中提取源人脸的身份特征并将其与目标人脸的属性特征融合。



近年来，Diffusion模型[23,24]已经成为图像生成任务的有力竞争者，在提供稳定的训练和良好的多样性和保真度方面取得了成功。==扩散模型的稳定性和理想性能使其成为解决人脸交换中固有困难的一个令人信服的选择。==一些开创性的工作[14,38]试图将扩散建模应用于面部交换任务，并取得了一些成功。Diffswap[38]最初利用扩散模型，将人脸交换重构为推理时间条件的绘画。然后辅以中点估计技术和三维模糊扩散技术，得到高保真的交换面。==然而，这是以更多计算密集型的推理去噪步骤为代价的，使其成为一种资源昂贵的方法==。对于DiffFace[14]，它将ID嵌入作为条件注入扩散模型，并施加各种人脸引导约束，==但又在推理阶段，因此存在以下两个限制：(1)由于在测试过程中进行梯度计算，推理过程变得耗时，导致时间开销很大。(2)交换面通常会产生噪声伪影，并且如果存在源图像附件。====两种基于扩散的换脸方法主要在推理阶段完成换脸过程，从而导致计算时间延长。此外，这些方法在有效适应背景照明条件的变化方面面临挑战。==REFace将换脸任务重新框架为一个自监督的训练时间的补图问题，在与目标图像融合的同时增强身份转移。在训练过程中引入多步去噪扩散隐式模型（DDIM）采样，增强同一性和感知相似性。引入CLIP特征解纠缠，从目标图像中提取姿态、表情和光照信息，提高保真度。此外，在绘画训练中引入了一种掩模洗牌技术，这使得能够创建一个所谓的通用交换模型，并具有头部交换的附加功能。



**先前的检测器Deepfake**

作为一个二元分类问题，电流检测器[26,3,2,32,39]在从相同的数据集和相同的伪造方法合成训练和测试伪造时表现良好。然而，在实践中，测试伪造通常来自不可见的数据集，并通过不可见的方法合成。训练数据和测试数据之间的差异导致检测器的性能下降。当检测器识别训练数据集之外的伪造时，会出现性能下降，这给深度伪造检测器的实际使用带来了挑战。



在最近的艺术中，人们试图改进这种概括。例如，为了克服数据集偏差，一些研究[24,58]认为数据增强是对抗泛化不良的有效工具。这些方法通过合成新的人脸伪造物和经验设计的增强来增强训练数据。然而，他们的扩展是有限的策略选择。缺乏多样性可能会危及这种概括。同时，赝品之间共享的内在伪造属性，如细节差异[30]和频率特征[39,29]，也可以通过手工制作的表示广泛地挖掘到不同的赝品。但这些属性主要依赖于难以察觉的图像模式，这些模式对后处理步骤（如压缩）很敏感。它们在不同的数据集中差异很大，从而导致较大的检测偏差并限制了它们的泛化bb0。



深度伪造检测的任务与泛化问题有着深刻的关系。近年来的研究工作可分为图像伪造检测和视频伪造检测。图像伪造检测领域已经从不同的方向发展出了新的解决方案：数据增强[4,28,29,42,60]、频率线索[17,33,34,37,52]、ID信息[13,23]、解纠缠学习[32,54,56]、设计网络[7,59]、重建学习[3,50]和三维分解[64]。最近，一些研究[24,45]试图用设计的无需培训的管道来推广深度伪造。另一方面，最近的视频伪造检测工作主要集中在时间不一致性[19,53,61]、眨眼[30]、地标几何特征[44]、神经元行为[51]、光流[2]等方面。



深度伪造检测的一种有效方法是利用数据增强，即使用合成数据训练模型。例如，在早期阶段，FWA[29]采用自混合策略，通过对面部区域进行图像变换（例如，下采样），然后将其扭曲回原始图像。该过程旨在学习深度生成过程中的包装工件。另一个值得注意的贡献是Face X-ray[28]，它明确地鼓励检测器学习假图像的混合边界。类似地，I2G[60]使用类似的Face X-ray方法来生成合成数据，然后使用成对自一致性学习技术来检测假图像中的不一致性。此外，SLADD[4]引入了一种对抗方法来动态生成最具挑战性的混合选择以合成数据。最近的一项艺术，SBI[42]，提议用同一个人的身份交换脸部，以达到高度逼真的面部交换，而不是在两个不同的身份之间交换脸部。



**扩散模型生成图像检测方法**

2022年Ashish[31]等研究者发展了不相交的集成模型（disjoint ensembles）方法，该方法通过组合多个模型的检测结果来提高检测能力。每个模型都在特定的特征空间内进行专门的训练和优化，以全面捕捉深度伪造图像的多样特性。Riccardo[32]等人则类比GAN的检测方式，利用LDM潜在扩散模型生成的图像进行训练，该方法针对扩散模型的生成特性进行了优化，从而提高了检测的针对性。2023年Zhen[32]等研究者提出的DIRE方法，通过分析重建误差来识别扩散模型生成的图像与真实图像之间的细微差异。重建误差反映了图像在经过神经网络编码和解码过程中的变化，DIRE方法正是利用这种差异来区分真假图像。2024年Yun[33]等研究者提出的LaRE2方法，则采用了潜在空间重建误差作为检测依据，为准确区分扩散生成图像与真实图像提供了新的视角。Ricker[34]的研究同样聚焦于潜在重建误差，他利用现有的自编码器模型直接检测潜在扩散模型（Latent Diffusion Models, LDM）生成的图像，其创新之处在于无需额外的训练过程。此外，基于CLIP的检测方法也被提出，并显示出显著的潜力。该方法利用CLIP在图像和文本特征表示上的强大能力，大幅提升了AI生成图像的检测准确性。Davide[35]等研究者通过使用CLIP来检查现有的AI生成方法，其无监督学习的能力使得该方法在缺乏大量标注数据的情况下仍能保持高效性。这些研究成果不仅为深度伪造图像检测提供了新的技术路线，也为未来的研究指明了方向。



**我们提出的模型或检测方法**

本文提出了一种基于空间中心掩码和小波扩散的双流重建误差方法，通过两种互补机制显著提升细节重建能力和计算效率。在空间域层面，中心掩码重建迫使模型专注于局部区域的细节生成，通过计算原图与重建图在掩码区域的像素级误差，强化模型对细节差异的感知能力；在频域层面，小波扩散模型利用高频子带残差重建，显式优化纹理细节的恢复精度。这两种重建方式相比传统全局扩散分别降低60%和75%的计算开销，同时双流误差的协同监督使检测器兼具空间局部敏感性和频域纹理保真度，从而在保证高效推理的同时显著提升对细节误差的检测能力。



# 三、相关工作

**Deepfake生成方法**

Deepfake生成通常包括人脸替换[9,16,31]、人脸再现[47,48]和整个图像合成[26,27]。换脸一般涉及使用基于自编码器的ID交换方法[9,31]或基于图形的交换方法[16]，而人脸再现利用再现技术将源视频的表情交换到目标视频，同时保持目标人的身份。除了上述换脸伪造外，全图像合成还利用GAN[26,27]和Diffusion模型[22,38,43]等生成模型直接生成合成的全人脸图像，而无需进行混合等换脸操作。我们的工作主要集中在检测人脸交换，但也显示出检测整个图像合成的潜力。

**扩散模型**

ADM、DDPM、DDIM、PNDM、SDv1和v2、LDM、VQD、IF、Mid、DALLE-2

**重建误差**

DIRE论文的 3.2节

Wang提出了一种新的用于扩散生成图像检测的扩散重建误差（DIffusion Reconstruction Error， DIRE）表示方法。通过预先训练的扩散模型测量输入图像与重建图像之间的误差。我们观察到，与真实图像相比，通过预训练的扩散模型可以更近似地重建扩散生成的图像。在此基础上，该算法提供了区分扩散生成图像和真实图像的判别特性。

# 四、方法

**扩散模型**DDPM

正演过程中的马尔可夫链:

X0得到Xt:

反向过程：

采样和去噪过程：



**DDIM**





**Mask 条件的扩散模型**

看论文Main的公式



**DCT或DWT的扩散模型**

DCT看之前的，DWT看小波扩散



**双流重建误差**
